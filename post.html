<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>B√†i vi·∫øt - ANARO Coffee</title>
  <meta name="description" content="B√†i vi·∫øt chi ti·∫øt tr√™n blog ANARO Coffee.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
  <link rel="stylesheet" href="blog.css">
  
  <!-- Enhanced meta tags for social sharing -->
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="ANARO Coffee Blog">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@anarocoffee">
  <meta name="author" content="ANARO Coffee">
  
  <!-- JSON-LD structured data -->
  <script type="application/ld+json" id="structured-data">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "publisher": {
      "@type": "Organization",
      "name": "ANARO Coffee",
      "url": "https://anarocoffee.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://anarocoffee.com/logo.png"
      }
    },
    "author": {
      "@type": "Organization",
      "name": "ANARO Coffee"
    }
  }
  </script>
</head>
<body>
  <header class="site-header" role="banner">
    <div class="container">
      <a class="brand" href="index-cart.html">ANARO COFFEE</a>
      <nav class="site-nav" aria-label="Ch√≠nh">
        <a href="index-cart.html">Mua l·∫ª</a>
        <a href="wholesale.html">Gi√° s·ªâ</a>
        <a href="checkout.html">Thanh to√°n</a>
        <a href="blog.html">Blog</a>
      </nav>
    </div>
  </header>

  <main class="main">
    <div class="container">
      <!-- Loading state -->
      <div class="status" id="status" aria-live="polite">ƒêang t·∫£i...</div>
      
      <!-- Progress bar for loading -->
      <div id="loading-progress" style="display:none;">
        <div style="width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;">
          <div id="progress-bar" style="width:0%;height:100%;background:var(--brand);transition:width 0.3s;"></div>
        </div>
      </div>
      
      <!-- Main content area -->
      <div id="post-root"></div>
      
      <!-- Error state template -->
      <div id="error-template" style="display:none;">
        <div style="text-align:center;padding:3rem;background:var(--ink);border-radius:12px;border:1px solid var(--border);">
          <div style="font-size:3rem;margin-bottom:1rem;">üòï</div>
          <h2 style="color:var(--brand);margin-bottom:1rem;">Oops! C√≥ l·ªói x·∫£y ra</h2>
          <p style="color:var(--muted);margin-bottom:2rem;" id="error-message">Kh√¥ng th·ªÉ t·∫£i b√†i vi·∫øt n√†y.</p>
          <a href="blog.html" class="cta-btn">‚Üê Quay l·∫°i Blog</a>
        </div>
      </div>
      
      <!-- Reading progress indicator -->
      <div id="reading-progress" style="position:fixed;top:0;left:0;width:0%;height:3px;background:var(--brand);z-index:1000;transition:width 0.1s;"></div>
      
      <!-- Social sharing buttons -->
      <div id="social-sharing" style="display:none;position:fixed;left:20px;top:50%;transform:translateY(-50%);z-index:100;">
        <div style="display:flex;flex-direction:column;gap:12px;background:rgba(255,255,255,0.95);padding:12px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.1);">
          <button onclick="shareOnFacebook()" class="social-share-btn facebook" title="Chia s·∫ª l√™n Facebook">
            <i class="fab fa-facebook-f"></i>
          </button>
          <button onclick="shareOnTwitter()" class="social-share-btn twitter" title="Chia s·∫ª l√™n Twitter">
            <i class="fab fa-twitter"></i>
          </button>
          <button onclick="copyToClipboard()" class="social-share-btn copy" title="Sao ch√©p li√™n k·∫øt">
            <i class="fas fa-link"></i>
          </button>
        </div>
      </div>
      
      <!-- Back to top button -->
      <button id="back-to-top" onclick="scrollToTop()" style="display:none;position:fixed;bottom:30px;right:30px;width:50px;height:50px;border-radius:50%;background:var(--brand);color:white;border:none;cursor:pointer;box-shadow:0 4px 15px rgba(0,0,0,0.2);transition:all 0.3s;" title="L√™n ƒë·∫ßu trang">
        <i class="fas fa-arrow-up"></i>
      </button>
    </div>
  </main>

  <!-- FOOTER -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-info">
          <h3>‚òï ANARO Coffee</h3>
          <p>Th∆∞∆°ng hi·ªáu c√† ph√™ ch·∫•t l∆∞·ª£ng cao, mang ƒë·∫øn tr·∫£i nghi·ªám tuy·ªát v·ªùi t·ª´ nh·ªØng h·∫°t c√† ph√™ tuy·ªÉn ch·ªçn.</p>
          <div class="contact-info">
            <div class="contact-item" onclick="openGoogleMaps()"><span class="icon">üìç</span><span>78 ƒêa Ph∆∞·ªõc B√¨nh Ch√°nh TP.HCM</span></div>
            <div class="contact-item" onclick="makePhoneCall()"><span class="icon">üìû</span><span>0918337071</span></div>
            <div class="contact-item" onclick="sendEmail()"><span class="icon">‚úâÔ∏è</span><span>anmy1909@gmail.com</span></div>
            <div class="contact-item"><span class="icon">üïí</span><span>M·ªü c·ª≠a: 8:00 - 22:00 h√†ng ng√†y</span></div>
          </div>
        </div>
        <div class="social-section">
          <h4>K·∫øt n·ªëi v·ªõi ANARO Coffee</h4>
          <div class="social-links">
            <a href="https://facebook.com/anarocoffee" class="social-link facebook" target="_blank" onclick="trackSocialClick('facebook')"><i class="fab fa-facebook-f"></i></a>
            <a href="https://instagram.com/anarocoffee" class="social-link instagram" target="_blank" onclick="trackSocialClick('instagram')"><i class="fab fa-instagram"></i></a>
            <a href="https://tiktok.com/@anarocoffee" class="social-link tiktok" target="_blank" onclick="trackSocialClick('tiktok')"><i class="fab fa-tiktok"></i></a>
          </div>
          <div class="map-container">
            <div class="map-overlay">ANARO Coffee Store</div>
            <div class="map-placeholder" onclick="openGoogleMaps()" title="Click ƒë·ªÉ xem b·∫£n ƒë·ªì">
              <div>
                <div><span style="animation: spin 1s linear infinite; display:none;">üîÑ</span> Nh·∫•n ƒë·ªÉ xem b·∫£n ƒë·ªì</div>
                <small>78 ƒêa Ph∆∞·ªõc, B√¨nh Ch√°nh, TP.HCM</small>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        ¬© 2025 ANARO Coffee. All rights reserved. | Thi·∫øt k·∫ø v·ªõi <span class="heart">‚ù§Ô∏è</span> t·∫°i Vi·ªát Nam
      </div>
    </div>
  </footer>

  <script>
  function openGoogleMaps(){ 
    const address = encodeURIComponent("78 ƒêa Ph∆∞·ªõc, B√¨nh Ch√°nh, TP.HCM, Vietnam"); 
    window.open(`https://www.google.com/maps/search/?api=1&query=${address}`,'_blank','noopener,noreferrer'); 
  }
  function makePhoneCall(){ 
    const p = '0918337071'; 
    window.location.href = `tel:${p}`; 
  }
  function sendEmail(){ 
    const email = 'anmy1909@gmail.com'; 
    const subject = encodeURIComponent('Li√™n h·ªá t·ª´ website ANARO Coffee'); 
    const body = encodeURIComponent('Ch√†o ANARO Coffee,\\n\\nT√¥i mu·ªën li√™n h·ªá v·ªÅ...\\n\\nTr√¢n tr·ªçng,'); 
    window.location.href = `mailto:${email}?subject=${subject}&body=${body}`; 
  }
  function trackSocialClick(p){ 
    console.log('Social media clicked:', p); 
  }

  // Enhanced post loading with progress tracking
  function updateProgress(current, total) {
    const progressBar = document.getElementById('progress-bar');
    const loadingProgress = document.getElementById('loading-progress');
    
    if (progressBar && loadingProgress) {
      loadingProgress.style.display = 'block';
      const percentage = (current / total) * 100;
      progressBar.style.width = `${percentage}%`;
      
      if (percentage === 100) {
        setTimeout(() => {
          loadingProgress.style.display = 'none';
        }, 500);
      }
    }
  }

  // Show error state
  function showError(message) {
    const status = document.getElementById('status');
    const errorTemplate = document.getElementById('error-template');
    const errorMessage = document.getElementById('error-message');
    
    if (status) status.style.display = 'none';
    if (errorTemplate && errorMessage) {
      errorMessage.textContent = message;
      errorTemplate.style.display = 'block';
    }
  }

  // Update page meta tags dynamically
  function updateMetaTags(title, description, image, url) {
    document.title = `${title} - ANARO Coffee Blog`;
    
    // Update meta description
    let metaDesc = document.querySelector('meta[name="description"]');
    if (!metaDesc) {
      metaDesc = document.createElement('meta');
      metaDesc.name = 'description';
      document.head.appendChild(metaDesc);
    }
    metaDesc.content = description;
    
    // Update Open Graph tags
    updateMetaTag('property', 'og:title', title);
    updateMetaTag('property', 'og:description', description);
    updateMetaTag('property', 'og:url', url || window.location.href);
    if (image) updateMetaTag('property', 'og:image', image);
    
    // Update Twitter tags
    updateMetaTag('name', 'twitter:title', title);
    updateMetaTag('name', 'twitter:description', description);
    if (image) updateMetaTag('name', 'twitter:image', image);
    
    // Update structured data
    const structuredData = document.getElementById('structured-data');
    if (structuredData) {
      const data = JSON.parse(structuredData.textContent);
      data.headline = title;
      data.description = description;
      data.url = url || window.location.href;
      data.datePublished = new Date().toISOString();
      if (image) data.image = image;
      structuredData.textContent = JSON.stringify(data, null, 2);
    }
  }

  function updateMetaTag(attr, name, content) {
    let tag = document.querySelector(`meta[${attr}="${name}"]`);
    if (!tag) {
      tag = document.createElement('meta');
      tag.setAttribute(attr, name);
      document.head.appendChild(tag);
    }
    tag.content = content;
  }

  // Reading progress indicator
  function setupReadingProgress() {
    const progressBar = document.getElementById('reading-progress');
    if (!progressBar) return;

    window.addEventListener('scroll', () => {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      progressBar.style.width = scrolled + '%';
    });
  }

  // Social sharing functions
  function shareOnFacebook() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
  }

  function shareOnTwitter() {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(document.title);
    window.open(`https://twitter.com/intent/tweet?url=${url}&text=${title}`, '_blank', 'width=600,height=400');
  }

  function copyToClipboard() {
    navigator.clipboard.writeText(window.location.href).then(() => {
      const btn = document.querySelector('.social-share-btn.copy');
      const originalText = btn.title;
      btn.title = 'ƒê√£ sao ch√©p!';
      btn.style.background = '#28a745';
      setTimeout(() => {
        btn.title = originalText;
        btn.style.background = '';
      }, 2000);
    });
  }

  // Back to top functionality
  function scrollToTop() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // Show/hide back to top button
  function setupBackToTop() {
    const backToTopBtn = document.getElementById('back-to-top');
    const socialSharing = document.getElementById('social-sharing');
    
    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (scrollTop > 300) {
        if (backToTopBtn) backToTopBtn.style.display = 'block';
        if (socialSharing) socialSharing.style.display = 'block';
      } else {
        if (backToTopBtn) backToTopBtn.style.display = 'none';
        if (socialSharing) socialSharing.style.display = 'none';
      }
    });
  }

  // Initialize post enhancements
  function setupPostEnhancements() {
    setupReadingProgress();
    setupBackToTop();
    
    // Smooth scroll for anchor links
    document.addEventListener('click', function(e) {
      if (e.target.matches('a[href^="#"]')) {
        e.preventDefault();
        const targetId = e.target.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      }
    });

    // Track CTA clicks
    document.addEventListener('click', function(e) {
      if (e.target.matches('.cta-btn')) {
        console.log('CTA clicked:', e.target.href);
        trackSocialClick('cta_click');
      }
    });
  }
  </script>

  <!-- Load blog script v√† kh·ªüi ch·∫°y -->
  <script src="blog.js"></script>
  <script>
  // Enhanced initialization with error handling
  function initSinglePost() {
    if (typeof window.Blog !== 'undefined' && window.Blog.renderSinglePost) {
      console.log('[Blog] Initializing single post...');
      
      // Enhance the renderSinglePost function with meta updates
      const originalRenderSinglePost = window.Blog.renderSinglePost;
      window.Blog.renderSinglePost = async function() {
        try {
          await originalRenderSinglePost();
          
          // Setup enhanced features after post loads
          setupPostEnhancements();
          
        } catch (error) {
          console.error('[Blog] Error rendering post:', error);
          showError('Kh√¥ng th·ªÉ t·∫£i b√†i vi·∫øt. Vui l√≤ng th·ª≠ l·∫°i sau.');
        }
      };
      
      window.Blog.renderSinglePost();
    } else {
      console.warn('[Blog] Blog object not ready, retrying...');
      setTimeout(initSinglePost, 100);
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSinglePost);
  } else {
    initSinglePost();
  }

  // Handle browser back/forward navigation
  window.addEventListener('popstate', function(event) {
    if (event.state && event.state.slug) {
      window.Blog.renderSinglePost();
    }
  });
  </script>

</body>
</html>